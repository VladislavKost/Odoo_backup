# Документация

Это приложение написано на языке программирования Python и предназначено 
для взаимодействия с API сервиса Swapi и базой данных Odoo. 
Оно позволяет получать информацию о планетах и персонажах "Звездных войн" и загружать её в базу данных Odoo.

### Использование
Для работы приложения необходимо иметь следующие зависимости:
- Python 3
- aiohttp
- requests
- xmlrpc.client
- tqdm

### Установка зависимостей:
pip install aiohttp requests tqdm

или

pip install -r requirements.txt

### Подготовка
Для работы с приложением необходимо создать файл конфигурации config.ini, 
который содержит следующие параметры:

[Odoo]
* url = URL-адрес сервера Odoo
* db = имя БД Odoo
* username = имя пользователя с правами администратора
* password = пароль пользователя

[Swapi]
* planet_url = URL-адрес API Swapi для получения информации о планетах
* character_url = URL-адрес API Swapi для получения информации о персонажах
* image_url = URL-адрес API Swapi для получения информации об изображениях

Содержимое файла config.ini должно быть заполнено соответствующими значениями.

### Получение параметров
Функция parameters() принимает путь к файлу конфигурации через командную строку и возвращает словарь параметров из файла конфигураций, id пользователя и объект для работы с моделями в базе данных Odoo.

### Генерация URL-адресов
Функция generate_urls() принимает базовый URL-адрес API Swapi и 
возвращает список URL-адресов для запросов в асинхронном режиме.

### Класс Asynchron
Класс Asynchron используется для выполнения асинхронных запросов к 
API Swapi. Он содержит методы request_entity() и 
request_photo(), которые выполняют запросы к сущностям(планетам и героям) или изображениям по 
переданному URL-адресу и возвращают JSON-данные или 
бинарные данные изображения соответственно. 
Метод request_all() выполняет 
асинхронные запросы через вышеупомянутые функции к списку URL-адресов 
и возвращает список результатов.

### Класс Planets
Класс Planets содержит метод generate_planet_info(json_list), 
который принимает список JSON-объектов с информацией о планетах и 
создает словарь с необходимыми данными о планетах.

### Логирование
Приложение ведет логирование событий.<br>
Логи записываются в файл UploadInformation.log и используют формат: "<дата и время> 
<уровень логирования>: <сообщение>".<br>
В логи записывается информация об ошибках и о 
загруженных сущностях с информацией о них. Приложение отслеживает такие ошибки как:
ошибка подключения к базе данных(неверное название БД, неверный логин или пароль, неверный localhost), ошибка получения данных из API и 
информация о адресе запроса с ошибкой.